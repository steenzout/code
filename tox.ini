[tox]
envlist = py27-B002_Magical_Web_Servers
deps = -rrequirements.txt


[pytest]
pep8maxlinelength = 119
norecursedirs = .git .tox env coverage docs
pep8ignore =
    docs/conf.py ALL


[testenv]
usedevelop = True
deps =
    -rrequirements-test.txt
    B002_Magical_Web_Servers: -rB002_Magical_Web_Servers/requirements.txt

passenv = ANSIBLE_ASK_SUDO_PASS HOME LANG LC_ALL

commands =
    py.test -q --basetemp={envtmpdir} --confcutdir=.. -n 1 \
        --junitxml=tests/junit.xml \
        --cov-report xml --cov B002_Magical_Web_Servers \
        --cov-report=html \
        --cov-report term-missing \
        --pep8 \
        {posargs}
    autopep8 \
        --in-place \
        --aggressive \
        --recursive \
        --max-line-length 119 \
        --ignore=W503 \
        B002_Magical_Web_Servers


[testenv:docs]
usedevelop = False
changedir = docs
deps = -rrequirements-docs.txt

commands =
    make dummy
    make apidoc
    make coverage
    make changes
    make html

whitelist_externals =
    /usr/bin/make
